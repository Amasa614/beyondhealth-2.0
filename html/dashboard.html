<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>playground</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="profile">
            <p>Jeffery Crentsil</p>
        </div>
        <div class="sidebar">
            <div class="sidebar-menu">
                <div class="sidebar-header"><h3>Dashboard</h3></div>
                <div class="menu">
                    <ul>
                        <li>Home</li>
                        <li>Reports</li>
                        <li>DDx and clinical Plans</li>
                        <li>Settings</li>
                    </ul>
                    <div class="sidebar-logout">Log out</div>
                </div>
            </div>
        </div>

        <div class="divider"></div>
        <div class="divider-1"></div>

        <div class="main-body">
            <div class="text-area">

                <div class="input-area">
                    <div class="examples">
                        <p>Try an example:</p>
                        <div class="example-1">Chest Pain DDx</div>
                        <div class="example-2">ADHF Clinical plan</div>
                    </div>
                    <div class="input-header">
                        <p>Main complaint</p>
                    </div>
                    <textarea id="myInput" placeholder="Type here"></textarea>
                    <div class="buttons">
                        <button class="primary">Differential diagnosis</button>
                        <button class="secondary">Clinical plan</button>
                        <button class="submit" id="submit" onclick="generateResults()">Generate</button>
                    </div>
                    <div class="output-container">
                        <p id="myOutput"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/he/he.js"></script>
    <script>
      const API_KEY = "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";
      const submitButton = document.querySelector('#submit');
      const outputText = document.getElementById('myOutput');

      function typeWriter(text, delay) {
          return new Promise(resolve => {
              const encodedText = he.encode(text); // Encode the entire message using HTML entities
              let index = 0;
              const interval = setInterval(() => {
                  outputText.textContent += encodedText[index];
                  index++;
                  if (index >= encodedText.length) {
                      clearInterval(interval);
                      resolve();
                  }
              }, delay);
          });
      }

      async function generateResults() {
          const inputText = document.getElementById('myInput').value;
          console.log("Input Text:", inputText);

          const options = {
              method: 'POST',
              headers: {
                  'Authorization': `Bearer ${API_KEY}`,
                  'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                  model: "gpt-3.5-turbo",
                  messages: [{ role: "user", content: inputText }],
                  max_tokens: 750
              })
          };

          outputText.textContent = ''; // Clear the output text

          try {
              const response = await fetch('https://api.openai.com/v1/chat/completions', options);
              const data = await response.json();
              console.log("API Response:", data);
              const message = data.choices[0].message.content;
              console.log("Response Message:", message);

              await typeWriter(message, 50); // Type out the message with a delay of 50ms per character
          } catch (error) {
              console.error(error);
              // Handle any errors that occur during the API request
          }
      }

     
      submitButton.addEventListener('click', generateResults);
  </script>
        
</body>
</html>
